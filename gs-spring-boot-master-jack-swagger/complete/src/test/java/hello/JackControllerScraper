package hello;

import java.util.Map;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider;
import org.springframework.core.type.filter.AnnotationTypeFilter;
import org.springframework.stereotype.Controller;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.method.HandlerMethod;
import org.springframework.web.servlet.mvc.method.RequestMappingInfo;
import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
public class JackScrapeControllerIT // extends AbstractTestNGSpringContextTests 
{
    
    @Autowired
    private RequestMappingHandlerMapping requestMappingHandlerMapping;



    @Test
    public void getAllControllerBeans() throws Exception {
       
    	ClassPathScanningCandidateComponentProvider scanner = new ClassPathScanningCandidateComponentProvider(false);
        scanner.addIncludeFilter(new AnnotationTypeFilter(Controller.class));
        
        for (BeanDefinition beanDefinition : scanner.findCandidateComponents("hello"))
        {
            System.out.println("XXX: " + beanDefinition.getBeanClassName());
        }
    }
    
    // this one is good!
    @Test
    public void getAllRequestMappingHandlers()
    {   	
    	
    	Map<RequestMappingInfo, HandlerMethod> mapper = requestMappingHandlerMapping.getHandlerMethods();
    	
    	for (Map.Entry<RequestMappingInfo, HandlerMethod> entry : mapper.entrySet())
    	{
    		System.out.println("Key : " + entry.getKey() + " Value : " + entry.getValue());
    	}
    	System.out.println(mapper.size());
    	
    }
    
   

}
